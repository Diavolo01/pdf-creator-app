<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Creator</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css">
  </head>
  <body>
    <div class="toolbar">    
      </select>
      <!--<button id="addImage">Add Image</button>-->
      <input type="text" id="imageUrlInput" placeholder="Enter image URL" />
      <button id="startDrawImg">Add Image</button>
      <button id="startDraw">Add Text</button>
      <button id="createHr">Create HR</button>
      <button id="addTemplate">Import Template</button>
      <button id="exportConfig">Export Config</button>
      <button id="importConfig">Import Config</button>
      <input type="file" id="importFile" style="display: none" />
      <button id="previewPdf">Preview PDF</button>
      <button id="copyItem" class="btn btn-secondary">Copy</button>
<button id="pasteItem" class="btn btn-secondary">Paste</button>
    </div>
    <div id="pdfControls" style="display: none;">
      <button id="prevPage">Previous Page</button>
      <span id="pageInfo">Page 1 of 1</span>
      <button id="nextPage">Next Page</button>
      <br>
      <br>
    </div>
    <div id="canvasContainer">
      <div id="canvas" ></div>
    </div>

    <div id="textboxProperties">
      <h3>Textbox Properties</h3>
      <p>Textbox Index: <span id="textboxId">None</span></p>
      <label>Object Name: <input id="textboxName" type="text">
      <br><br>
      <label>Font Size: <input id="fontSize" type="number" value="16"></label>
      <br><br>
      <label>Content: <input id="textContent" type="text"></label>
      <br><br>
      <label>Position X: <input id="posX" type="number"></label>
      <br><br>
      <label>Position Y: <input id="posY" type="number"></label>
      <br><br>
      <p>Type: <span id="type">Textbox</span></p>
      <p>Number: <span id="number-display">Loading...</span></p>
        <label>Image Src: <input id="ImgSrc" type="text"></label>
        <button id="updateLastImage">Update Last Image</button>
        <script>
          //  document.addEventListener("DOMContentLoaded", async () => {
    // ดึง UUID จาก URL
//     const pathSegments = window.location.pathname.split("/");
//     const uuid = pathSegments[2]; // ดึง UUID จาก "/edit/xxxxxx"
//     console.log("it in");
//     if (!uuid) {
//         console.error("No UUID found in URL");
//         return;
//     }

//     console.log(`Loading config for UUID: ${uuid}`);

//     try {
//         // โหลดไฟล์ config JSON
//         const response = await fetch(`/files/upload/${uuid}.json`);
        
//         if (!response.ok) {
//             console.warn(`Config file not found for UUID: ${uuid}`);
//             return;
//         }

//         const configData = await response.json();
//         console.log("Loaded Config:", configData);

//         // อัปเดต UI ตามข้อมูล JSON
//         importConfigFromServer(configData);
//     } catch (error) {
//         console.error("Error loading config:", error);
//     }
// });
// function importConfigFromServer(config) {
//     try {
//       const canvas = document.getElementById("canvas");
//       // Clear the canvas first
//       canvas.innerHTML = "";
  
//       // Set canvas dimensions
//       if (config.canvasWidth && config.canvasHeight) {
//         canvas.style.width = `${config.canvasWidth}px`;
//         canvas.style.height = `${config.canvasHeight}px`;
//       }
//       canvas.appendChild(selectionBox);
  
//       // Restore template image if it exists in the config
//       if (config.templateSrc) {
//         const templateImg = document.createElement("img");
//         templateImg.id = "templateImage";
//         templateImg.style.position = "absolute";
//         templateImg.style.top = "0";
//         templateImg.style.left = "0";
//         templateImg.style.zIndex = "-1";
//         templateImg.src = config.templateSrc;
//         canvas.appendChild(templateImg);
//         canvas.appendChild(selectionBox);
//       }
  
//       // Add all items back to the canvas
//       config.items.forEach((item) => {
//         if (item.src) {
//           const imgContainer = createImageContainer(item.src);
//           imgContainer.style.left = `${item.x}px`;
//           imgContainer.style.top = `${item.y}px`;
//           imgContainer.style.width = `${item.width}px`;
//           imgContainer.style.height = `${item.height}px`;
//           imgContainer.style.zIndex = "1";
//           canvas.appendChild(imgContainer);
//         } else if (item.text) {
//           createTextbox(item.x, item.y, item.text, item.textBoxName);
//           const textbox = document.querySelector(
//             `[data-name="${item.textBoxName}"]`
//           );
//           if (textbox) {
//             textbox.style.width = `${item.width}px`;
//             textbox.style.height = `${item.height}px`;
//             textbox.style.fontSize = item.fontSize || "16px";
//             textbox.style.color = item.fontColor || "#000000";
//             textbox.style.textAlign = item.textAlign || "left";
//             textbox.style.zIndex = "1";
//           }
//         }
//         // Add horizontal type
//         else if (item.type === "div") {
//           const hr = createHr(item.x, item.y);
//           hr.style.left = `${item.x}px`;
//           hr.style.top = `${item.y}px`;
//           hr.style.width = `${item.width || 300}px`;
//         }
//       });
  
//       // If PDF info is available in the config, update PDF controls
//       if (config.pdfInfo) {
//         pdfControls.style.display = "block";
//         currentPage = config.pdfInfo.currentPage || 1;
//         totalPages = config.pdfInfo.totalPages || 1;
//         updatePageInfo();
//       } else {
//         pdfControls.style.display = "none";
//       }
//     } catch (error) {
//       console.error("Error importing config:", error);
//       alert("Invalid configuration file. Please try again.");
//     }
//   }
  // const pathSegments = window.location.pathname.split("/")[2]??'';
  //         var number = pathSegments[2]??''; // Get the number from "/edit/123"
  //          })
      </script>
  </div>
  
      
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
  <script src="handletext.js"></script>
    <script src="script.js"></script>
    <script src="js/jspdf.umd.min.js"></script>
    <script src="js/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-lib@0.0.149/build/pdf.min.js"></script>
    <script src="
https://cdn.jsdelivr.net/npm/axios@1.8.4/dist/axios.min.js
"></script>
  </body>
</html>
